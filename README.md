# Hybrid Financial Recommender

**Тема проекта:** реализация гибридной рекомендательной системы для онлайн-сервиса финансовых услуг.  
Проект объединяет контентный и коллаборативный подходы для персонализации предложений по кредитам, депозитам и страховкам.

---

## Структура проекта
```
financial_recommender/
│
├── app/
│   └── gradio_app.py              # Веб-интерфейс на Gradio
│
├── recommender/
│   ├── data_generator.py          # Генерация синтетических данных
│   ├── preprocessing.py           # Предобработка данных
│   ├── content_based.py           # Контентная модель (Cosine Similarity)
│   ├── collaborative.py           # Коллаборативная модель (LightFM)
│   ├── hybrid.py                  # Гибридная модель
│   ├── matrix_factorization.py    # SVD модель
│   ├── advanced_hybrid.py         # Продвинутая гибридная модель
│   ├── evaluation.py              # Метрики оценки
│   └── logger.py                  # Логирование
│
├── data/                          # CSV-файлы пользователей, продуктов и рейтингов
├── logs/                          # Логи запусков пайплайна
├── notebooks/                     # Jupyter-ноутбуки для анализа
│   ├── 01_data_analysis.ipynb     # Анализ данных
│   ├── 02_model_training.ipynb    # Обучение моделей
│   ├── 03_evaluation.ipynb        # Оценка моделей
│   └── 04_embeddings_visualization.ipynb # Визуализация эмбеддингов
├── README.md                      # Описание проекта
└── requirements.txt               # Зависимости
```

---

## Что делает система

1. **Генерация данных** — создание синтетических данных о пользователях и финансовых продуктах
2. **Предобработка** — нормализация признаков, кодирование категориальных переменных
3. **Обучение моделей**:
   - **Content-based** — рекомендации на основе схожести продуктов
   - **Collaborative (LightFM)** — матричная факторизация
   - **SVD** — матричная факторизация из scikit-learn
   - **Hybrid** — комбинация контентной и коллаборативной моделей
   - **Advanced Hybrid** — адаптивная гибридная модель
4. **Оценка качества** — расчет Precision@K, Recall@K, NDCG@K, Coverage@K
5. **Визуализация** — анализ эмбеддингов продуктов с помощью PCA и t-SNE
6. **Интерфейс** — веб-интерфейс на Gradio для тестирования рекомендаций

---

## Результаты эксперимента

**Лучшая модель:** SVD (матричная факторизация) показала наилучшие результаты:
- Precision@K: 0.024619
- Recall@K: 0.107454  
- NDCG@K: 0.061468
- Inference Time: 0.074125 с

**Текущая гибридная модель** требует доработки — не показала преимуществ над отдельными моделями из-за слабой работы контентной компоненты.

---

## Быстрый старт

```bash
#### Установка зависимостей
pip install -r requirements.txt

#### Запуск веб-интерфейса
python app.gradio_app.py
```

Откроется Gradio UI:
Введите `User ID` (1–999) -> получите персонализированные финансовые рекомендации.

Для запуска анализа и экспериментов используйте ноутбуки в папке `notebooks/`.

---

## Дальнейшие шаги

1. **Улучшение контентной модели** — добавление более релевантных признаков продуктов
2. **Оптимизация гибридизации** — реализация каскадирования и switching стратегий
3. **Работа с реальными данными** — интеграция с API финансовых сервисов
4. **Повышение производительности** — оптимизация кода и кэширование рекомендаций
5. **Добавление бизнес-метрик** — оценка потенциальной выручки и конверсии
6. **Создание MVP продукта** — подготовка решения для коммерческого внедрения

---

## Проект включает

- Полный цикл разработки рекомендательной системы
- Модульную архитектуру для легкого расширения
- Детальную оценку качества моделей
- Визуализацию и анализ эмбеддингов
- Готовый веб-интерфейс для демонстрации
- Код размещен на GitHub для дальнейшего развития